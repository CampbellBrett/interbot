FROM registry.cto.ai/official_images/node:2-12.13.1-stretch-slim

WORKDIR /ops

ADD package.json .
RUN npm install --production

#ADD index.js .

ADD app.js .
ADD views views

# daemon
ENV STATE_DIR="/root/"
ENV CONFIG_DIR="/root/"

# sdk
ENV OPS_API_HOST="https://cto.ai/"
ENV OPS_API_PATH="api/v1/"
ENV OPS_TEAM_ID="8fff5b28-62a8-464d-a39e-50c30ecf52d9"
ENV OPS_ACCESS_TOKEN="eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJSakpHbVhIUWhWdmZaOFJBUFNkZkhUNGJQUExOLThLNnNHOWFEclR1clM0In0.eyJqdGkiOiJmZDZlMjcyOS0wYTVlLTRhM2UtYWMyNy03NzdiOTFlNmM0MWYiLCJleHAiOjE2MjYxNDk5MjgsIm5iZiI6MCwiaWF0IjoxNjIzNTU3OTI4LCJpc3MiOiJodHRwczovL2N0by5haS9hdXRoL3JlYWxtcy9vcHMiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiNTkxM2U5NGQtZTljNC00ZWE5LWFiYzItYWQxMGM5ZTdmYzhhIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoid3d3Iiwibm9uY2UiOiJlMDNiMmI3OC05NDlhLTQwOTYtYTcxZS02MjNjMWU4MmM0MTciLCJhdXRoX3RpbWUiOjE2MjI2NzI1MDAsInNlc3Npb25fc3RhdGUiOiIzYmI1M2M5Zi01ZmMwLTRiZjUtOTM3Ni05YjgwMmIxZTlhNzUiLCJhY3IiOiIwIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBlbWFpbCBwcm9maWxlIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJuYW1lIjoiS3lsZSBDYW1wYmVsbCIsInByZWZlcnJlZF91c2VybmFtZSI6ImtjIiwiZ2l2ZW5fbmFtZSI6Ikt5bGUiLCJmYW1pbHlfbmFtZSI6IkNhbXBiZWxsIiwiZW1haWwiOiJrY0BjdG8uYWkifQ.f5YjJTQApfJ-bvcHl_MTNXV8vh6XLbDn0aGn6GKPEDCpOZbxRpqfOE4jgR1vr_7S4FdLgTnPe63E7LbDR5oOMZU6Okrl8JKI8rlQ-HBzzMnGvEnjYlXVf9-367j_191KdoEx3HM-EbtTlh-wwPK90TQT8-i0aYZzUwWVKKbfGJdIwyfUcKJLZZGyCYcLLnVzHCKCBG2Wtq0Y-2UbvWmloM77CQLJdjsTnA7blGQWJtS0Yyr5XF6rrSn8XCvZ4buiUwIu3By33CgCQ7Y0EFBGmCMXnEK4M-_5f8AcuwObnJodRY25xL_W7paH2-zOVCUtjP8IqAU9eE8ePPHJkaZl-Q"

EXPOSE 3000
CMD ["/bin/sdk-daemon", "node", "/ops/app.js"]
